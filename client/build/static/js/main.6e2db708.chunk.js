(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{118:function(e,t,a){},176:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),s=(a(118),a(32)),i=a(12),l=a(9),u=a(20),d=a(13),j=a(222),p=a(177),b=a(63),h=a(213),m=a(223),x=a(233),g=a(2);var O=function(e){var t=e.name,a=e.label,n=e.handleChange,r=e.autoFocus,c=e.type;return Object(g.jsx)(h.a,{item:!0,xs:12,children:Object(g.jsx)(x.a,{name:t,onChange:n,variant:"outlined",required:!0,fullWidth:!0,label:a,autoFocus:r,type:c})})},f=a(221),v=Object(f.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",padding:e.spacing(2)},root:{"& .MuiTextField-root":{margin:e.spacing(1)}},form:{marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}})),y=function(e,t){switch(t.type){case"AUTH":return localStorage.setItem("profile",JSON.stringify(Object(u.a)({},t.payload))),{errorMessage:"",user:t.payload.result};case"SIGNED":return{errorMessage:"",user:JSON.parse(t.payload).result};case"LOGOUT":return localStorage.clear(),{errorMessage:"",user:{_id:"",name:"",email:""}};case"ERROR":return Object(u.a)(Object(u.a)({},e),{},{errorMessage:t.payload});default:return e}},w=a(36),S=a.n(w),C=a(54),k=a(47),R=a.n(k);R.a.interceptors.request.use((function(e){return localStorage.getItem("profile")&&(e.headers.Authorization="Bearer ".concat(JSON.parse(localStorage.getItem("profile")).token),e.headers.userId=JSON.parse(localStorage.getItem("profile")).result._id),e}));var N=function(e){return R.a.post("/user/signin",e)},T=function(e){return R.a.post("/user/signup",e)},M=function(e){return{signup:function(){var t=Object(C.a)(S.a.mark((function t(a,n){var r,c;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T(a);case 3:r=t.sent,c=r.data,e({type:"AUTH",payload:c}),n.push("/"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e({type:"ERROR",payload:t.t0.response.data.message});case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,a){return t.apply(this,arguments)}}(),signin:function(){var t=Object(C.a)(S.a.mark((function t(a,n){var r,c;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N(a);case 3:r=t.sent,c=r.data,e({type:"AUTH",payload:c}),n.push("/"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),e({type:"ERROR",payload:t.t0.response.data.message});case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,a){return t.apply(this,arguments)}}(),logout:function(t){e({type:"LOGOUT"}),t.push("/signin")}}},I={errorMessage:"",user:{_id:"",email:"",name:""}},E=Object(n.createContext)(I),A=function(e){var t=e.children,a=Object(n.useReducer)(y,I),r=Object(d.a)(a,2),c=r[0],o=r[1],s=M(o);return Object(n.useEffect)((function(){if(!c.user.name){var e=localStorage.getItem("profile");e&&o({type:"SIGNED",payload:e})}}),[c]),Object(g.jsx)(E.Provider,{value:{auth:c,actions:s},children:t})},U={name:"",email:"",password:"",confirmPassword:""};var B=function(){var e=Object(n.useState)(!1),t=Object(d.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(U),o=Object(d.a)(c,2),s=o[0],x=o[1],f=v(),y=Object(i.f)(),w=Object(n.useContext)(E),S=w.actions,C=S.signin,k=S.signup,R=w.auth.errorMessage,N=function(e){x(Object(u.a)(Object(u.a)({},s),{},Object(l.a)({},e.target.name,e.target.value)))};return Object(g.jsx)(j.a,{component:"main",maxWidth:"xs",children:Object(g.jsxs)(p.a,{elevation:3,className:f.paper,children:[Object(g.jsx)(b.a,{variant:"h5",children:a?"Sign Up":"Sign In"}),Object(g.jsx)(b.a,{variant:"h6",style:{color:"#ed4337"},children:R}),Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a?k(s,y):C(s,y)},className:f.form,children:[Object(g.jsxs)(h.a,{container:!0,spacing:2,children:[a&&Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(O,{name:"name",label:"Name",handleChange:N,autoFocus:a})}),Object(g.jsx)(O,{name:"email",label:"Email Address",handleChange:N,type:"email",autoFocus:!a}),Object(g.jsx)(O,{name:"password",label:"Password",handleChange:N,type:"password"}),a&&Object(g.jsx)(O,{name:"confirmPassword",label:"Confirm Password",handleChange:N,type:"password"})]}),Object(g.jsx)(m.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:f.submit,children:a?"Sign Up":"Sign In"}),Object(g.jsx)(h.a,{container:!0,justify:"flex-end",children:Object(g.jsx)(h.a,{item:!0,children:Object(g.jsx)(m.a,{onClick:function(){r((function(e){return!e}))},children:a?"Already have an account? Sign In":"Don't have an account? Sign Up"})})})]})]})})},W=a(219),D=a(231),F=a(224);var _=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),o=Object(d.a)(c,2),s=o[0],l=o[1],u=Object(n.useState)(""),h=Object(d.a)(u,2),O=h[0],f=h[1],v=Object(i.f)(),y=Object(n.useContext)(E).auth.user,w=function(){var e=Object(C.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get("/chatRooms");case 3:t=e.sent,a=t.data.rooms,r(a),l(a[0]),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){y.name&&w()}),[y]);var k=function(){var e=O||s;v.push("/chatRooms/".concat(e))};return y.name?Object(g.jsx)(j.a,{maxWidth:"sm",style:{textAlign:"center",height:"50vh",marginTop:"100px"},children:Object(g.jsxs)(p.a,{elevation:1,style:{padding:"50px 20px"},children:[Object(g.jsxs)(b.a,{variant:"h4",align:"center",children:["Hello ",y.name]}),Object(g.jsx)(b.a,{variant:"h4",align:"center",children:"Welcome to Chat app!"}),Object(g.jsxs)("div",{style:{marginTop:"100px"},children:[Object(g.jsx)(b.a,{variant:"h6",align:"center",children:"Select the room"}),Object(g.jsxs)(W.a,{variant:"outlined",style:{width:"50%"},children:[Object(g.jsx)(D.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:s,onChange:function(e){l(e.target.value)},children:a.map((function(e){return Object(g.jsx)(F.a,{value:e,children:e},e)}))}),Object(g.jsx)(b.a,{variant:"h6",align:"center",style:{margin:"10px 0"},children:"or create a new one"}),Object(g.jsx)(x.a,{value:O,onChange:function(e){f(e.target.value)},label:"Room name",variant:"outlined",onKeyPress:function(e){return"Enter"===e.key?k():null}}),Object(g.jsx)(m.a,{variant:"contained",color:"primary",style:{marginTop:"20px"},size:"large",onClick:k,children:O?"Create new room":"Join Room"})]})]})]})}):Object(g.jsx)(B,{})},H=a(225),P=a(226),J=Object(f.a)((function(){return{navLink:{textDecoration:"none"},navLogo:{textDecoration:"none",flexGrow:1}}}));var L=function(){var e=J(),t=Object(n.useContext)(E),a=t.auth.user,r=t.actions.logout,c=Object(i.f)();return Object(g.jsx)(H.a,{position:"static",children:Object(g.jsxs)(P.a,{children:[Object(g.jsx)(b.a,{className:e.navLogo,variant:"h5",color:"inherit",component:s.b,to:"/",children:"WEB CHAT"}),a.name?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(b.a,{variant:"h5",style:{marginRight:"20px"},children:a.name}),Object(g.jsx)(m.a,{variant:"contained",color:"secondary",onClick:function(){return r(c)},children:"Logout"})]}):Object(g.jsx)(m.a,{variant:"outlined",color:"inherit",component:s.b,to:"/signin",children:"Login"})]})})},z=a(228),G=a(220),Y=a(178),q=a(229),K=a(237),V=a(230),$=a(235),Q=a(232),X=Object(f.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));var Z=function(e){var t=e.setSnackbarAlert,a=e.snackbarAlert,n=a.open,r=a.user,c=a.text,o=X();return Object(g.jsx)("div",{className:o.root,children:Object(g.jsx)($.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:n,autoHideDuration:5e3,onClose:function(e,n){"clickaway"!==n&&t(Object(u.a)(Object(u.a)({},a),{},{open:!1}))},children:Object(g.jsx)(Q.a,{severity:"success",elevation:6,variant:"filled",children:"".concat(r,": ").concat(c)})})})},ee=function(e,t){switch(t.type){case"FETCH_ROOM":return t.payload.result;case"UPDATE_ROOM":return t.payload.updatedRoom;default:return e}},te=function(e){return{joinChat:function(e,t){try{t.open(),t.emit("join",e)}catch(a){console.log(a)}},updateRoom:function(t){try{t.on("updateRoom",(function(t){e({type:"UPDATE_ROOM",payload:t})}))}catch(a){console.log(a)}},leaveChat:function(e){try{e.disconnect(),e.off()}catch(t){console.log(t)}},sendMessage:function(e,t,a){a.emit("sendMessage",{message:e,roomName:t})}}},ae={_id:"",users:[{_id:"",name:""}],name:"",messages:[{id:"",body:"",createdAt:"",user:""}]},ne=Object(n.createContext)(ae),re=function(e){var t=e.children,a=Object(n.useReducer)(ee,ae),r=Object(d.a)(a,2),c=r[0],o=r[1],s=te(o);return Object(g.jsx)(ne.Provider,{value:{chatRoom:c,actions:s},children:t})},ce=a(104),oe=function(e){return localStorage.getItem("profile")?JSON.parse(localStorage.getItem("profile"))[e]:""},se=Object(f.a)((function(e){return{root:{display:"flex",flexDirection:"column"},currentUserMessage:{position:"relative",maxWidth:"80%",margin:"5px 10px",borderRadius:"5px",padding:"5px 10px",backgroundColor:"#5c6bc0",opacity:"0.9",alignSelf:"flex-end",overflowWrap:"break-word"},otherUserMessage:{position:"relative",maxWidth:"80%",margin:"5px 10px",borderRadius:"5px",padding:"5px 10px",backgroundColor:"#b0bec5",opacity:"0.9",alignSelf:"flex-start",overflowWrap:"break-word"},messageHeader:{letterSpacing:".1rem"},messageBody:{fontWeight:"400",paddingRight:"50px"},messageTime:{position:"absolute",bottom:"3px",right:"3px",color:e.palette.text.secondary},iframeContainer:{position:"relative",overflow:"hidden",width:"100%",paddingTop:"56.25%"},iframe:{position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",height:"100%"}}})),ie=a(105),le=a.n(ie);var ue=function(e){var t=e.user,a=t.name,n=t._id,r=e.body,c=e.createdAt,o=e.currentUser,s=se(),i=o._id===n,l=r.match(/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/);return Object(g.jsx)("div",{className:s.root,children:Object(g.jsxs)("div",{className:i?s.currentUserMessage:s.otherUserMessage,children:[l?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h4",{className:s.messageHeader,children:i?"Me":a}),Object(g.jsx)("iframe",{width:"100%",height:"200",src:"https://www.youtube.com/embed/".concat(l[1]),title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),Object(g.jsx)("a",{href:r,target:"_blank",rel:"noreferrer",children:r})]}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h4",{className:s.messageHeader,children:i?"Me":a}),Object(g.jsx)("h3",{className:s.messageBody,children:r})]}),Object(g.jsx)("p",{className:s.messageTime,children:le()(c).format("hh:mm")})]})})},de=a(227),je=a.p+"static/media/chat-background.10f91aa9.jpg",pe=Object(f.a)((function(e){return{root:{height:"700px",maxWidth:"800px",margin:"0 auto",padding:"15px",marginTop:e.spacing(5),backgroundColor:"#9fa8da",border:"1px solid #b5b5b5",borderRadius:"5px",display:"flex",flexDirection:"column",alignItems:"stretch"},container:{height:"550px",marginBottom:"30px"},messageBox:{height:"inherit",overflowY:"scroll",background:"url(".concat(je,")"),backgroundColor:"#c5cae9",backgroundBlendMode:"lighten",backgroundSize:"cover",borderRadius:"3px",boxShadow:"2px 2px 2px rgba(0,0,0,0.7) inset"},usersBox:{height:"inherit",overflowY:"auto"},orange:{color:e.palette.getContrastText(de.a[500]),backgroundColor:de.a[500]},progress:{height:"50px",maxWidth:"100px",margin:"100px auto"}}}));var be=function(e){var t=e.match.params,a=pe(),r=Object(n.useContext)(ne),c=r.chatRoom,o=r.actions,i=o.updateRoom,l=o.joinChat,j=o.leaveChat,p=o.sendMessage,O=Object(n.useContext)(E).auth.user,f=Object(n.useState)(""),v=Object(d.a)(f,2),y=v[0],w=v[1],S=Object(n.useState)({user:"",text:"",open:!1}),C=Object(d.a)(S,2),k=C[0],R=C[1],N=Object(n.useState)(null),T=Object(d.a)(N,2),M=T[0],I=T[1],A=Object(n.useRef)(),U=function(e){A.current&&A.current.scrollIntoView({behavior:e,alignToTop:!0})};return Object(n.useEffect)((function(){!function(){var e=Object(ce.io)({allowCredentials:!0,extraHeaders:{token:"Bearer ".concat(oe("token")),userProfile:JSON.stringify(oe("result"))}});I(e)}(),setTimeout((function(){U("auto")}),1e3)}),[]),Object(n.useEffect)((function(){t&&O.name&&M&&l(t.name,M)}),[O,t,M]),Object(n.useEffect)((function(){if(M)return i(M),M.on("botMessage",(function(e){R({user:e.user,text:e.text,open:!0})})),function(){j(M)}}),[M]),O.name?(null===t||void 0===t?void 0:t.name)!==c.name?Object(g.jsx)("div",{className:a.progress,children:Object(g.jsx)(z.a,{color:"secondary",size:60})}):Object(g.jsxs)("div",{className:a.root,children:[Object(g.jsx)(Z,{snackbarAlert:k,setSnackbarAlert:R}),Object(g.jsxs)(h.a,{container:!0,alignItems:"center",children:[Object(g.jsx)(h.a,{item:!0,xs:4,children:Object(g.jsx)(b.a,{variant:"h5",align:"center",gutterBottom:!0,children:"People in chat"})}),Object(g.jsx)(h.a,{item:!0,xs:8,children:Object(g.jsxs)(b.a,{variant:"h4",align:"center",gutterBottom:!0,children:["#",c.name]})})]}),Object(g.jsxs)(h.a,{container:!0,className:a.container,children:[Object(g.jsx)(h.a,{item:!0,xs:4,className:a.usersBox,children:Object(g.jsx)(G.a,{children:c.users.map((function(e){return Object(g.jsxs)(Y.a,{button:!0,children:[Object(g.jsx)(q.a,{children:Object(g.jsx)(K.a,{className:a.orange,children:e.name?e.name[0]:""})}),Object(g.jsx)(V.a,{primary:e.name})]},e._id)}))})}),Object(g.jsxs)(h.a,{item:!0,xs:8,className:a.messageBox,children:[c.messages.map((function(e,t){return Object(g.jsx)(ue,Object(u.a)(Object(u.a)({},e),{},{currentUser:O}),t)})),Object(g.jsx)("div",{ref:A,style:{height:"30px",width:"100%"}})]})]}),Object(g.jsxs)(h.a,{container:!0,alignItems:"flex-end",children:[Object(g.jsx)(h.a,{item:!0,xs:4,align:"center",children:Object(g.jsx)(m.a,{component:s.b,to:"/",variant:"contained",color:"secondary",children:"Leave the Room"})}),Object(g.jsx)(h.a,{item:!0,xs:8,children:Object(g.jsx)("form",{onSubmit:function(e){e.preventDefault(),p(y,c.name,M),w(""),setTimeout((function(){U("smooth")}),300)},children:Object(g.jsxs)(h.a,{container:!0,spacing:1,alignItems:"flex-end",className:a.input,children:[Object(g.jsx)(h.a,{item:!0,xs:8,children:Object(g.jsx)(x.a,{fullWidth:!0,placeholder:"type a message",autoFocus:!0,value:y,onChange:function(e){return w(e.target.value)}})}),Object(g.jsx)(h.a,{item:!0,xs:4,children:Object(g.jsx)(m.a,{variant:"contained",type:"submit",color:"primary",fullWidth:!0,children:"Send"})})]})})})]})]}):Object(g.jsx)(B,{})};var he=function(){return Object(g.jsxs)(s.a,{children:[Object(g.jsx)(L,{}),Object(g.jsxs)(i.c,{children:[Object(g.jsx)(i.a,{exact:!0,path:"/",component:_}),Object(g.jsx)(i.a,{exact:!0,path:"/signin",component:B}),Object(g.jsx)(i.a,{exact:!0,path:"/chatRooms/:name",component:be})]})]})};o.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(A,{children:Object(g.jsx)(re,{children:Object(g.jsx)(he,{})})})}),document.getElementById("root"))}},[[176,1,2]]]);
//# sourceMappingURL=main.6e2db708.chunk.js.map